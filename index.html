<!DOCTYPE html>
<!--[if IE 9]><html class="no-js ie9"><![endif]-->
<!--[if gt IE 9]><!--><html class="no-js"><!--<![endif]-->
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
		<title>UNIL HEC Calendar</title>
		<meta name="description" content="UNIL HEC Calendar with responsive design" />
		<meta name="keywords" content="responsive, calendar, jquery, plugin, full page, flexible, hec, unil, bachelor, master, autumn, spring, automne, printemps" />
		<meta name="author" content="Setrino" />
		<link rel="shortcut icon" href="../favicon.ico"> 
		<link rel="stylesheet" type="text/css" href="css/calendar.css" />
		<link rel="stylesheet" type="text/css" href="css/custom_1.css" />
		<script src="js/modernizr.custom.63321.js"></script>
	</head>
	<body>
		<div class="container">	
			<div class="custom-calendar-wrap custom-calendar-full">
                <div id="custom-inner" class="custom-inner">
                    <div class="custom-header clearfix">
                        <h2>UNIL HEC Calendar</h2>
                        <div id="dd" class="year-list" tabindex="1">Bachelor 1 Automne
                            <ul class="dropdown">
                                <li><a href="#">Bachelor 1 Automne</a></li>
                                <li><a href="#">Bachelor 1 Printemps</a></li>
                                <li><a href="#">Bachelor 2 Automne</a></li>
                                <li><a href="#">Bachelor 2 Printemps</a></li>
                            </ul>
                        </div>
                        <div id="groups">
                            <span class='groupA'>group A</span>
                            <span class='groupB'>group B</span>
                        </div>
                        <h3 class="custom-month-year">
                            <span id="custom-month" class="custom-month"></span>
                            <span id="custom-year" class="custom-year"></span>
                            <nav>
                                <span id="custom-prev" class="custom-prev"></span>
                                <span id="custom-next" class="custom-next"></span>
                                <span id="custom-current" class="custom-current" title="Got to current date">Today</span>
                            </nav>
                        </h3>
                    </div>
                    <div id="calendar" class="fc-calendar-container"></div>
                </div>
			</div>
			<div class='download_links'>
				<a href='#' class='json_file custom-current'>JSON</a> |
				<a href='#' class='ical_file custom-current'>iCal</a> |
				<a href='https://github.com/Setrino/calendar_scrapper' class='github'>
					GitHub</a>
			</div>
		</div><!-- /container -->
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
		<script type="text/javascript" src="js/jquery.calendario.js"></script>
		<script type="text/javascript" src="js/data.js"></script>
		<script type="text/javascript" src="js/json_requests.js"></script>
		<script type="text/javascript">	


		var json = new jsonEvents(function(value) {

				var cal = $( '#calendar' ).calendario( {
						onDayClick : function( $el, $contentEl, dateProperties ) {

							for( var key in dateProperties ) {
								console.log( key + ' = ' + dateProperties[ key ] );
							}
                            if( $contentEl.length > 0 ) {
                                showEvents( $contentEl, dateProperties );
                            }

						},
						caldata : codropsEvents,
						jsonEvents : value
					} ),
					$month = $( '#custom-month' ).html( cal.getMonthName() ),
					$year = $( '#custom-year' ).html( cal.getYear() );

				$( '#custom-next' ).on( 'click', function() {
					cal.gotoNextMonth( updateMonthYear );
				} );
				$( '#custom-prev' ).on( 'click', function() {
					cal.gotoPreviousMonth( updateMonthYear );
				} );
				$( '#custom-current' ).on( 'click', function() {
					cal.gotoNow( updateMonthYear );
				} );

				function updateMonthYear() {				
					$month.html( cal.getMonthName() );
					$year.html( cal.getYear() );
				}

				// you can also add more data later on. As an example:
				/*
				someElement.on( 'click', function() {
					
					cal.setData( {
						'03-01-2013' : '<a href="#">testing</a>',
						'03-10-2013' : '<a href="#">testing</a>',
						'03-12-2013' : '<a href="#">testing</a>'
					} );
					// goes to a specific month/year
					cal.goto( 3, 2013, updateMonthYear );

				} );
				*/
			
			});

			function DropDown(el) {
				this.dd = el;
				this.initEvents();
			}
			DropDown.prototype = {
				initEvents : function() {
					var obj = this;

					obj.dd.on('click', function(event){
						$(this).toggleClass('active');
						event.stopPropagation();
					});	
				}
			}

			$(function() {

				var dd = new DropDown( $('#dd') );

				$(document).click(function() {
					// all dropdowns
					$('.year-list').removeClass('active');
				});

			});

            function showEvents( $contentEl, dateProperties ) {

                var $wrapper = $('#custom-inner');

                hideEvents();

                var $events = $( '<div id="custom-content-reveal" class="custom-content-reveal"><h4>Events for ' +
                                dateProperties.monthname + ' ' + dateProperties.day + ', ' + dateProperties.year +
                                    '</h4></div>'),
                        $close = $( '<span class="custom-content-close"></span>' ).on( 'click', hideEvents );

                console.log($contentEl);
                $events.append( "<div class='custom-content-text'></br>" + $contentEl.html() + '</div>' , $close ).insertAfter( $wrapper );
                $('#custom-content-reveal').css('height', $('.custom-content-text').height() + 85);

                setTimeout( function() {
                    $events.css( 'top', '0%' );
                }, 25 );

            }
            function hideEvents() {

                var $events = $( '#custom-content-reveal'),
                transEndEventNames = {
                    'WebkitTransition' : 'webkitTransitionEnd',
                    'MozTransition' : 'transitionend',
                    'OTransition' : 'oTransitionEnd',
                    'msTransition' : 'MSTransitionEnd',
                    'transition' : 'transitionend'
                },
                        transEndEventName = transEndEventNames[ Modernizr.prefixed( 'transition' ) ];
                if( $events.length > 0 ) {

                    $events.css( 'top', '100%' );
                    Modernizr.csstransitions ? $events.on( transEndEventName, function() { $( this ).remove(); } ) : $events.remove();

                }

            }
		</script>
	</body>
</html>
